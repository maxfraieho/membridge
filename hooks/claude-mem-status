#!/bin/bash
# Show sync status â€” prints project identity + doctor info
# Usage: claude-mem-status [--project <name>]
set -euo pipefail

MEMBRIDGE_DIR="${MEMBRIDGE_DIR:-$HOME/membridge}"

set -a
source "$MEMBRIDGE_DIR/config.env"
set +a

while [[ $# -gt 0 ]]; do
  case $1 in
    --project)
      export CLAUDE_PROJECT_ID="$2"
      shift 2
      ;;
    *)
      echo "Unknown option: $1"
      echo "Usage: claude-mem-status [--project <name>]"
      exit 1
      ;;
  esac
done

source "$MEMBRIDGE_DIR/venv/bin/activate"
export PATH="$HOME/npm-global/bin:$PATH"
python "$MEMBRIDGE_DIR/sqlite_minio_sync.py" print_project
echo
python "$MEMBRIDGE_DIR/sqlite_minio_sync.py" doctor
