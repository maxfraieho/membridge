#!/bin/bash
# Manual pull â€” interactive, shows output in terminal
# Usage: claude-mem-pull [--project <name>] [--no-restart-worker]
set -euo pipefail

MEMBRIDGE_DIR="${MEMBRIDGE_DIR:-$HOME/membridge}"

set -a
source "$MEMBRIDGE_DIR/config.env"
set +a

while [[ $# -gt 0 ]]; do
  case $1 in
    --project)
      export CLAUDE_PROJECT_ID="$2"
      shift 2
      ;;
    --no-restart-worker)
      export MEMBRIDGE_NO_RESTART_WORKER=1
      shift
      ;;
    *)
      echo "Unknown option: $1"
      echo "Usage: claude-mem-pull [--project <name>] [--no-restart-worker]"
      exit 1
      ;;
  esac
done

"$MEMBRIDGE_DIR/validate-env.sh"

source "$MEMBRIDGE_DIR/venv/bin/activate"
export PATH="$HOME/npm-global/bin:$PATH"
python "$MEMBRIDGE_DIR/sqlite_minio_sync.py" pull_sqlite
